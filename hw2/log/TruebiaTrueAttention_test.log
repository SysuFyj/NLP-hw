WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

WARNING:tensorflow:From /data/fyj/project/Sentiment-Analysis-DL/lstm_model.py:25: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From /data/fyj/project/Sentiment-Analysis-DL/lstm_model.py:27: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /data/fyj/project/Sentiment-Analysis-DL/lstm_model.py:33: The name tf.truncated_normal is deprecated. Please use tf.random.truncated_normal instead.

WARNING:tensorflow:From /data/fyj/project/Sentiment-Analysis-DL/lstm_model.py:36: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /data/fyj/project/Sentiment-Analysis-DL/lstm_model.py:165: The name tf.nn.rnn_cell.DropoutWrapper is deprecated. Please use tf.compat.v1.nn.rnn_cell.DropoutWrapper instead.

WARNING:tensorflow:From /data/fyj/project/Sentiment-Analysis-DL/lstm_model.py:165: LSTMCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.LSTMCell, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /data/fyj/project/Sentiment-Analysis-DL/lstm_model.py:166: MultiRNNCell.__init__ (from tensorflow.python.ops.rnn_cell_impl) is deprecated and will be removed in a future version.
Instructions for updating:
This class is equivalent as tf.keras.layers.StackedRNNCells, and will be replaced by that in Tensorflow 2.0.
WARNING:tensorflow:From /data/fyj/project/Sentiment-Analysis-DL/lstm_model.py:43: bidirectional_dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.Bidirectional(keras.layers.RNN(cell))`, which is equivalent to this API
WARNING:tensorflow:From /home/users/liuxiao/anaconda3/envs/fyj_nlp/lib/python3.6/site-packages/tensorflow_core/python/ops/rnn.py:464: dynamic_rnn (from tensorflow.python.ops.rnn) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `keras.layers.RNN(cell)`, which is equivalent to this API
WARNING:tensorflow:From /home/users/liuxiao/anaconda3/envs/fyj_nlp/lib/python3.6/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:958: Layer.add_variable (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.add_weight` method instead.
WARNING:tensorflow:From /home/users/liuxiao/anaconda3/envs/fyj_nlp/lib/python3.6/site-packages/tensorflow_core/python/ops/rnn_cell_impl.py:962: calling Zeros.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
WARNING:tensorflow:From /data/fyj/project/Sentiment-Analysis-DL/lstm_model.py:125: The name tf.nn.xw_plus_b is deprecated. Please use tf.compat.v1.nn.xw_plus_b instead.

WARNING:tensorflow:From /data/fyj/project/Sentiment-Analysis-DL/lstm_model.py:150: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

WARNING:tensorflow:From /home/users/liuxiao/anaconda3/envs/fyj_nlp/lib/python3.6/site-packages/tensorflow_core/python/ops/clip_ops.py:301: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /data/fyj/project/Sentiment-Analysis-DL/lstm_model.py:154: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From run_LSTM_model.py:131: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2024-11-19 23:30:23.877500: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2024-11-19 23:30:23.943810: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: NVIDIA GeForce RTX 3090 major: 8 minor: 6 memoryClockRate(GHz): 1.695
pciBusID: 0000:3d:00.0
2024-11-19 23:30:23.944235: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudart.so.10.0'; dlerror: libcudart.so.10.0: cannot open shared object file: No such file or directory
2024-11-19 23:30:23.944340: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcublas.so.10.0'; dlerror: libcublas.so.10.0: cannot open shared object file: No such file or directory
2024-11-19 23:30:23.944406: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcufft.so.10.0'; dlerror: libcufft.so.10.0: cannot open shared object file: No such file or directory
2024-11-19 23:30:23.944470: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcurand.so.10.0'; dlerror: libcurand.so.10.0: cannot open shared object file: No such file or directory
2024-11-19 23:30:23.944537: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusolver.so.10.0'; dlerror: libcusolver.so.10.0: cannot open shared object file: No such file or directory
2024-11-19 23:30:23.944594: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcusparse.so.10.0'; dlerror: libcusparse.so.10.0: cannot open shared object file: No such file or directory
2024-11-19 23:30:23.944651: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcudnn.so.7'; dlerror: libcudnn.so.7: cannot open shared object file: No such file or directory
2024-11-19 23:30:23.944666: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1641] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
2024-11-19 23:30:23.945650: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2024-11-19 23:30:23.996243: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2600000000 Hz
2024-11-19 23:30:24.008905: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555b8ce61dc0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2024-11-19 23:30:24.009052: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2024-11-19 23:30:24.308224: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x555b8cc92060 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2024-11-19 23:30:24.308325: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA GeForce RTX 3090, Compute Capability 8.6
2024-11-19 23:30:24.308513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-19 23:30:24.308520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      
WARNING:tensorflow:From run_LSTM_model.py:132: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From run_LSTM_model.py:133: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

CUDA_VISIBLE_DEVICES: None
CUDA_VISIBLE_DEVICES: 3
CUDA_VISIBLE_DEVICES: 3
Loading test data...
Testing...
Test Loss:    1.3, Test Acc:  50.40%
Precision, Recall and F1-Score...
              precision    recall  f1-score   support

         sad       0.40      0.55      0.46       549
       happy       0.52      0.65      0.58       812
       angry       0.77      0.33      0.46       271
        fear       0.60      0.20      0.30       168
     disgust       0.82      0.28      0.42       132
    surprise       0.83      0.28      0.42        72

    accuracy                           0.50      2004
   macro avg       0.66      0.38      0.44      2004
weighted avg       0.56      0.50      0.49      2004

Confusion Matrix...
[[300 231   8   7   2   1]
 [256 531  13   8   2   2]
 [ 69 107  89   4   1   1]
 [ 52  76   4  33   3   0]
 [ 43  49   1   2  37   0]
 [ 22  28   1   1   0  20]]
Time usage: 0:00:51
